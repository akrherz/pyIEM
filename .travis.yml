sudo: required
addons:
  hosts:
    - iemdb
virtualenv:
  system_site_packages: true
language: python
python:
  - "2.7"
before_install:
  - sudo apt-get install -qq python-pyproj python-mpltoolkits.basemap python-matplotlib python-numpy python-scipy python-psycopg2
install:
  - "pip install Shapely"
  - "pip install coveralls"
  - "pip install Pillow"
  - "pip install python-metar"
#  - "pip install --allow-external basemap -r requirements.txt"
before_script:
  - psql -c 'create database postgis;' -U postgres
  - psql -c 'create user nobody;' -U postgres
  - psql -U postgres -c "create extension postgis" postgis
  - psql -c 'create database portfolio;' -U postgres
  - psql -c 'create database iem;' -U postgres
  - psql -U postgres -c "create extension postgis" iem
  - psql -U postgres -f data/schema/iem.sql iem
  - psql -U postgres -f data/schema/postgis.sql postgis
  - psql -U postgres -f data/schema/portfolio.sql portfolio
script:
  "coverage run --source=pyiem setup.py test"
after_success:
  coveralls
